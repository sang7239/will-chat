{"ast":null,"code":"var _jsxFileName = \"/Users/willhwang/go/src/github.com/will-slack/apiclient/client/src/components/MessageList/index.js\";\nimport React, { useEffect, useState, useContext, Component } from 'react';\nimport Compose from '../Compose';\nimport Toolbar from '../Toolbar';\nimport ToolbarButton from '../ToolbarButton';\nimport Message from '../Message';\nimport moment from 'moment';\nimport ChannelContext from '../../context/ChannelContext';\nimport './MessageList.css';\nimport axios from 'axios';\nimport AuthContext from '../../context/AuthContext';\nimport propTypes from 'prop-types';\nexport default class MessageList extends Component {\n  constructor(props) {\n    super(props);\n    this.ws = new WebSocket(\"ws://localhost:3030\");\n\n    this.scrollToBottom = () => {\n      this.messagesEnd.scrollIntoView({\n        behavior: \"smooth\"\n      });\n    };\n\n    this.update = message => {\n      // const {auth} = this.context\n      // axios.get('https://localhost:4000/v1/channels/'+ this.state.currentChannel, \n      // {\n      //   headers: {\n      //     \"Authorization\": auth.token\n      //   }\n      // }\n      // ).then(response => {\n      //     let msgs = response.data.map(results => {\n      //       return {\n      //         author: results.creatorID,\n      //         message: results.body,\n      //         timestamp: results.createdAt,\n      //         firstName: results.firstname,\n      //         lastName: results.lastname\n      //       }\n      //     })\n      //     this.setState({messages: msgs});\n      //   });\n      this.ws.send(message);\n    };\n\n    this.deleteChannel = e => {\n      const {\n        auth\n      } = this.context;\n      e.preventDefault();\n      axios.delete(\"https://localhost:4000/v1/channels/\" + this.state.currentChannel, {\n        headers: {\n          Authorization: auth.token\n        }\n      }).then(result => {\n        if (result.status == 200) {\n          window.location.reload(false);\n        }\n      }).catch(e => {\n        console.log(e);\n      });\n    };\n\n    this.editChannel = e => {\n      const {\n        auth\n      } = this.context;\n      e.preventDefault();\n      axios({\n        method: 'PATCH',\n        url: \"https://localhost:4000/v1/channels/\" + this.state.currentChannel,\n        headers: {\n          Authorization: auth.token\n        },\n        data: {\n          name: this.channelName.value,\n          description: this.description.value\n        }\n      }).then(result => {\n        if (result.status == 200) {\n          window.location.reload(false);\n        }\n      }).catch(e => {\n        console.log(e);\n      });\n    };\n\n    this.resetMessage = () => {\n      this.setState({\n        message: \"\",\n        color: \"\"\n      });\n    };\n\n    this.addUserToChannel = e => {\n      const {\n        auth\n      } = this.context;\n      e.preventDefault();\n      axios.get('https://localhost:4000/v1/users/' + this.userName.value, {\n        headers: {\n          \"Authorization\": auth.token\n        }\n      }).then(response => {\n        axios({\n          method: 'LINK',\n          url: \"https://localhost:4000/v1/channels/\" + this.state.currentChannel,\n          headers: {\n            Authorization: auth.token,\n            Link: response.data\n          }\n        }).then(result => {\n          if (result.status == 200) {\n            this.setState({\n              message: result.data,\n              color: \"green\"\n            });\n          }\n        }).catch(e => {\n          this.setState({\n            message: e.message,\n            color: \"red\"\n          });\n        });\n      });\n    };\n\n    this.removeUserFromChannel = e => {\n      const {\n        auth\n      } = this.context;\n      e.preventDefault();\n      axios.get('https://localhost:4000/v1/users/' + this.removeName.value, {\n        headers: {\n          \"Authorization\": auth.token\n        }\n      }).then(response => {\n        axios({\n          method: 'UNLINK',\n          url: \"https://localhost:4000/v1/channels/\" + this.state.currentChannel,\n          headers: {\n            Authorization: auth.token,\n            Link: response.data\n          }\n        }).then(result => {\n          console.log(result);\n\n          if (result.status == 200) {\n            this.setState({\n              message: result.data,\n              color: \"green\"\n            });\n          }\n        }).catch(e => {\n          this.setState({\n            message: e.message,\n            color: \"red\"\n          });\n          console.log(e);\n        });\n      });\n    };\n\n    this.renderMessages = messages => {\n      let MY_USER_ID = this.props.currentUserID;\n      let i = 0;\n      let messageCount = messages.length;\n      let tempMessages = [];\n\n      while (i < messageCount) {\n        let previous = messages[i - 1];\n        let current = messages[i];\n        let next = messages[i + 1];\n        let isMine = current.author === MY_USER_ID;\n        let currentMoment = moment(current.timestamp);\n        let prevBySameAuthor = false;\n        let nextBySameAuthor = false;\n        let startsSequence = true;\n        let endsSequence = true;\n        let showTimestamp = true;\n\n        if (previous) {\n          let previousMoment = moment(previous.timestamp);\n          let previousDuration = moment.duration(currentMoment.diff(previousMoment));\n          prevBySameAuthor = previous.author === current.author;\n\n          if (prevBySameAuthor && previousDuration.as('hours') < 1) {\n            startsSequence = false;\n          }\n\n          if (previousDuration.as('hours') < 1) {\n            showTimestamp = false;\n          }\n        }\n\n        if (next) {\n          let nextMoment = moment(next.timestamp);\n          let nextDuration = moment.duration(nextMoment.diff(currentMoment));\n          nextBySameAuthor = next.author === current.author;\n\n          if (nextBySameAuthor && nextDuration.as('hours') < 1) {\n            endsSequence = false;\n          }\n        }\n\n        tempMessages.push( /*#__PURE__*/React.createElement(Message, {\n          key: i,\n          isMine: isMine,\n          startsSequence: startsSequence,\n          endsSequence: endsSequence,\n          showTimestamp: showTimestamp,\n          data: current,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 248,\n            columnNumber: 9\n          }\n        })); // Proceed to the next message.\n\n        i += 1;\n      }\n\n      return tempMessages;\n    };\n\n    this.state = {\n      currentChannel: this.props.currentChannel,\n      currentChannelName: this.props.currentChannelName,\n      currentUserID: this.props.currentUserID,\n      isChannelCreator: this.props.isChannelCreator,\n      isPrivateChannel: this.props.isPrivateChannel,\n      messages: [],\n      message: \"\",\n      color: \"red\"\n    };\n    this.update = this.update.bind(this);\n  }\n\n  componentDidMount() {\n    const auth = this.context;\n\n    this.ws.onopen = () => {\n      // on connecting, do nothing but log it to the console\n      console.log('connected');\n    };\n\n    this.ws.onmessage = event => {\n      // on receiving a message, add it to the list of messages\n      console.log(event.data);\n    };\n\n    this.ws.onclose = () => {\n      console.log('disconnected'); // automatically try to reconnect on connection loss\n\n      this.setState({\n        ws: new WebSocket(\"ws://localhost:3030\")\n      });\n    };\n\n    this.scrollToBottom();\n  }\n\n  componentDidUpdate() {\n    this.scrollToBottom();\n  }\n\n  componentWillReceiveProps(newProps) {\n    const {\n      auth\n    } = this.context;\n    axios.get('https://localhost:4000/v1/channels/' + newProps.currentChannel, {\n      headers: {\n        \"Authorization\": auth.token\n      }\n    }).then(response => {\n      console.log(response);\n      let msgs = response.data.map(results => {\n        return {\n          author: results.creatorID,\n          message: results.body,\n          timestamp: results.createdAt,\n          firstName: results.firstname,\n          lastName: results.lastname\n        };\n      });\n      this.setState({\n        messages: msgs\n      });\n    });\n    this.setState({\n      currentChannel: newProps.currentChannel\n    });\n  }\n\n  render() {\n    const channelExists = this.state.currentChannel != \"\";\n    const isCreator = this.props.isChannelCreator;\n    const isPrivateChannel = this.props.isPrivateChannel;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      id: \"channel-header\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 268,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"message-list\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 269,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Toolbar, {\n      title: this.props.currentChannelName,\n      rightItems: [/*#__PURE__*/React.createElement(ToolbarButton, {\n        key: \"info\",\n        icon: \"ion-ios-information-circle-outline\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 273,\n          columnNumber: 15\n        }\n      }), /*#__PURE__*/React.createElement(ToolbarButton, {\n        key: \"video\",\n        icon: \"ion-ios-videocam\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 274,\n          columnNumber: 15\n        }\n      }), /*#__PURE__*/React.createElement(ToolbarButton, {\n        key: \"phone\",\n        icon: \"ion-ios-call\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 275,\n          columnNumber: 15\n        }\n      })],\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 270,\n        columnNumber: 11\n      }\n    }), isCreator ? /*#__PURE__*/React.createElement(\"div\", {\n      id: \"controls\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 13\n      }\n    }, isPrivateChannel ? /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 282,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"svg\", {\n      xmlns: \"http://www.w3.org/2000/svg\",\n      width: \"50\",\n      height: \"50\",\n      viewBox: \"0 0 8 8\",\n      \"data-toggle\": \"modal\",\n      \"data-target\": \"#AddToChannel\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 283,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"path\", {\n      d: \"M3 0v3h-3v2h3v3h2v-3h3v-2h-3v-3h-2z\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 284,\n        columnNumber: 23\n      }\n    }), /*#__PURE__*/React.createElement(\"title\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 285,\n        columnNumber: 23\n      }\n    }, \"Add User to Channel\")), /*#__PURE__*/React.createElement(\"svg\", {\n      xmlns: \"http://www.w3.org/2000/svg\",\n      width: \"50\",\n      height: \"50\",\n      viewBox: \"0 0 8 8\",\n      \"data-toggle\": \"modal\",\n      \"data-target\": \"#removeFromChannel\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 287,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"path\", {\n      d: \"M0 0v2h8v-2h-8z\",\n      transform: \"translate(0 3)\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 288,\n        columnNumber: 23\n      }\n    }), /*#__PURE__*/React.createElement(\"title\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 289,\n        columnNumber: 23\n      }\n    }, \"Remove User from Channel\"))) : null, /*#__PURE__*/React.createElement(\"svg\", {\n      xmlns: \"http://www.w3.org/2000/svg\",\n      width: \"50\",\n      height: \"50\",\n      viewBox: \"0 0 8 8\",\n      \"data-toggle\": \"modal\",\n      \"data-target\": \"#EditChannel\",\n      \"data-whatever\": \"@mdo\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 294,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"path\", {\n      d: \"M3.5 0l-.5 1.19c-.1.03-.19.08-.28.13l-1.19-.5-.72.72.5 1.19c-.05.1-.09.18-.13.28l-1.19.5v1l1.19.5c.04.1.08.18.13.28l-.5 1.19.72.72 1.19-.5c.09.04.18.09.28.13l.5 1.19h1l.5-1.19c.09-.04.19-.08.28-.13l1.19.5.72-.72-.5-1.19c.04-.09.09-.19.13-.28l1.19-.5v-1l-1.19-.5c-.03-.09-.08-.19-.13-.28l.5-1.19-.72-.72-1.19.5c-.09-.04-.19-.09-.28-.13l-.5-1.19h-1zm.5 2.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5-1.5-.67-1.5-1.5.67-1.5 1.5-1.5z\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 295,\n        columnNumber: 19\n      }\n    }), /*#__PURE__*/React.createElement(\"title\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 296,\n        columnNumber: 19\n      }\n    }, \"Edit Channel\")), /*#__PURE__*/React.createElement(\"svg\", {\n      xmlns: \"http://www.w3.org/2000/svg\",\n      width: \"50\",\n      height: \"50\",\n      viewBox: \"0 0 8 8\",\n      \"data-toggle\": \"modal\",\n      \"data-target\": \"#deleteChannel\",\n      \"data-whatever\": \"@mdo\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 298,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"path\", {\n      d: \"M3 0c-.55 0-1 .45-1 1h-1c-.55 0-1 .45-1 1h7c0-.55-.45-1-1-1h-1c0-.55-.45-1-1-1h-1zm-2 3v4.81c0 .11.08.19.19.19h4.63c.11 0 .19-.08.19-.19v-4.81h-1v3.5c0 .28-.22.5-.5.5s-.5-.22-.5-.5v-3.5h-1v3.5c0 .28-.22.5-.5.5s-.5-.22-.5-.5v-3.5h-1z\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 299,\n        columnNumber: 19\n      }\n    }), /*#__PURE__*/React.createElement(\"title\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 300,\n        columnNumber: 19\n      }\n    }, \"Delete Channel\"))) : null, channelExists ? /*#__PURE__*/React.createElement(Compose, {\n      currentChannel: this.state.currentChannel,\n      update: message => {\n        this.update(message);\n      },\n      currentUserFirstName: this.props.currentUserFirstName,\n      currentUserLastName: this.props.currentUserLastName,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 307,\n        columnNumber: 15\n      }\n    }) : /*#__PURE__*/React.createElement(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 312,\n        columnNumber: 15\n      }\n    }, \"Create or Join Channel\")), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 315,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"signup-form\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 316,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"modal fade\",\n      id: \"EditChannel\",\n      tabindex: \"-1\",\n      role: \"dialog\",\n      \"aria-labelledby\": \"exampleModalLabel\",\n      \"aria-hidden\": \"true\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 317,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"modal-dialog\",\n      role: \"document\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 318,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"form\", {\n      class: \"form-horizontal\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 319,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"col-xs-8 col-xs-offset-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 320,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"h2\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 321,\n        columnNumber: 29\n      }\n    }, \"Edit Channel\")), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 323,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      class: \"control-label col-xs-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 324,\n        columnNumber: 29\n      }\n    }, \"Channel Name\"), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"col-xs-8\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 325,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      class: \"form-control\",\n      name: \"edit_channel_name\",\n      required: \"required\",\n      placeholder: this.state.firstname,\n      ref: node => this.channelName = node,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 326,\n        columnNumber: 33\n      }\n    }))), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 331,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      class: \"control-label col-xs-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 332,\n        columnNumber: 29\n      }\n    }, \"Description\"), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"col-xs-8\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 333,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      class: \"form-control\",\n      name: \"edit_channel_description\",\n      placeholder: this.state.lastname,\n      ref: node => this.description = node,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 334,\n        columnNumber: 33\n      }\n    }))), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 342,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"col-xs-8 col-xs-offset-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 343,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      class: \"btn btn-primary btn-sm\",\n      onClick: e => {\n        this.editChannel(e);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 344,\n        columnNumber: 33\n      }\n    }, \"Save\")), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"col-xs-8 col-xs-offset-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 346,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      type: \"button\",\n      class: \"btn btn-primary btn-sm\",\n      \"data-dismiss\": \"modal\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 347,\n        columnNumber: 33\n      }\n    }, \"Close\"))))))), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"signup-form\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 356,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"modal fade\",\n      id: \"deleteChannel\",\n      tabindex: \"-1\",\n      role: \"dialog\",\n      \"aria-labelledby\": \"exampleModalLabel\",\n      \"aria-hidden\": \"true\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 357,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"modal-dialog\",\n      role: \"document\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 358,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"form\", {\n      class: \"form-horizontal\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 359,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"h2\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 360,\n        columnNumber: 25\n      }\n    }, \"Are you sure you want to delete this channel?\"), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 361,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"col-xs-8 col-xs-offset-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 362,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      class: \"btn btn-primary btn-sm\",\n      onClick: e => {\n        this.deleteChannel(e);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 363,\n        columnNumber: 33\n      }\n    }, \"YES\")), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"col-xs-8 col-xs-offset-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 365,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      type: \"button\",\n      class: \"btn btn-primary btn-sm\",\n      \"data-dismiss\": \"modal\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 366,\n        columnNumber: 33\n      }\n    }, \"NO\"))))))), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"signup-form\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 375,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"modal fade\",\n      id: \"AddToChannel\",\n      tabindex: \"-1\",\n      role: \"dialog\",\n      \"aria-labelledby\": \"exampleModalLabel\",\n      \"aria-hidden\": \"true\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 376,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"modal-dialog\",\n      role: \"document\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 377,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"form\", {\n      class: \"form-horizontal\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 378,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"col-xs-8 col-xs-offset-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 379,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"h2\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 380,\n        columnNumber: 29\n      }\n    }, \"Add User to Channel\")), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 382,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      class: \"control-label col-xs-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 383,\n        columnNumber: 29\n      }\n    }, \"Username\"), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"col-xs-8\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 384,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      class: \"form-control\",\n      name: \"edit_channel_name\",\n      required: \"required\",\n      placeholder: this.state.firstname,\n      ref: node => this.userName = node,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 385,\n        columnNumber: 33\n      }\n    }))), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"add-response\",\n      class: \"text-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 390,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      style: {\n        color: this.state.color\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 391,\n        columnNumber: 29\n      }\n    }, this.state.message)), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 393,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"col-xs-8 col-xs-offset-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 394,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      class: \"btn btn-primary btn-sm\",\n      onClick: e => {\n        this.addUserToChannel(e);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 395,\n        columnNumber: 33\n      }\n    }, \"Add\")), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"col-xs-8 col-xs-offset-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 397,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      type: \"button\",\n      class: \"btn btn-primary btn-sm\",\n      \"data-dismiss\": \"modal\",\n      onClick: this.resetMessage,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 398,\n        columnNumber: 33\n      }\n    }, \"Close\"))))))), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"signup-form\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 407,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"modal fade\",\n      id: \"removeFromChannel\",\n      tabindex: \"-1\",\n      role: \"dialog\",\n      \"aria-labelledby\": \"exampleModalLabel\",\n      \"aria-hidden\": \"true\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 408,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"modal-dialog\",\n      role: \"document\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 409,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"form\", {\n      class: \"form-horizontal\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 410,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"col-xs-8 col-xs-offset-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 411,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"h2\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 412,\n        columnNumber: 29\n      }\n    }, \"Remove User From Channel\")), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 414,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      class: \"control-label col-xs-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 415,\n        columnNumber: 29\n      }\n    }, \"Username\"), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"col-xs-8\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 416,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      class: \"form-control\",\n      name: \"edit_channel_name\",\n      required: \"required\",\n      placeholder: this.state.firstname,\n      ref: node => this.removeName = node,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 417,\n        columnNumber: 33\n      }\n    }))), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"remove-response\",\n      class: \"text-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 422,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      style: {\n        color: this.state.color\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 423,\n        columnNumber: 29\n      }\n    }, this.state.message)), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 425,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"col-xs-8 col-xs-offset-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 426,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      class: \"btn btn-primary btn-sm\",\n      onClick: e => {\n        this.removeUserFromChannel(e);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 427,\n        columnNumber: 33\n      }\n    }, \"Remove\")), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"col-xs-8 col-xs-offset-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 429,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      type: \"button\",\n      class: \"btn btn-primary btn-sm\",\n      \"data-dismiss\": \"modal\",\n      onClick: this.resetMessage,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 430,\n        columnNumber: 33\n      }\n    }, \"Close\")))))))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"message-list-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 440,\n        columnNumber: 9\n      }\n    }, this.renderMessages(this.state.messages)), /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        float: \"left\",\n        clear: \"both\"\n      },\n      ref: el => {\n        this.messagesEnd = el;\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 445,\n        columnNumber: 9\n      }\n    }));\n  }\n\n}\nMessageList.contextType = AuthContext;","map":{"version":3,"sources":["/Users/willhwang/go/src/github.com/will-slack/apiclient/client/src/components/MessageList/index.js"],"names":["React","useEffect","useState","useContext","Component","Compose","Toolbar","ToolbarButton","Message","moment","ChannelContext","axios","AuthContext","propTypes","MessageList","constructor","props","ws","WebSocket","scrollToBottom","messagesEnd","scrollIntoView","behavior","update","message","send","deleteChannel","e","auth","context","preventDefault","delete","state","currentChannel","headers","Authorization","token","then","result","status","window","location","reload","catch","console","log","editChannel","method","url","data","name","channelName","value","description","resetMessage","setState","color","addUserToChannel","get","userName","response","Link","removeUserFromChannel","removeName","renderMessages","messages","MY_USER_ID","currentUserID","i","messageCount","length","tempMessages","previous","current","next","isMine","author","currentMoment","timestamp","prevBySameAuthor","nextBySameAuthor","startsSequence","endsSequence","showTimestamp","previousMoment","previousDuration","duration","diff","as","nextMoment","nextDuration","push","currentChannelName","isChannelCreator","isPrivateChannel","bind","componentDidMount","onopen","onmessage","event","onclose","componentDidUpdate","componentWillReceiveProps","newProps","msgs","map","results","creatorID","body","createdAt","firstName","firstname","lastName","lastname","render","channelExists","isCreator","currentUserFirstName","currentUserLastName","node","float","clear","el","contextType"],"mappings":"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","sourcesContent":["import React, {useEffect, useState, useContext, Component} from 'react';\nimport Compose from '../Compose';\nimport Toolbar from '../Toolbar';\nimport ToolbarButton from '../ToolbarButton';\nimport Message from '../Message';\nimport moment from 'moment';\nimport ChannelContext from '../../context/ChannelContext'\nimport './MessageList.css';\nimport axios from 'axios';\nimport AuthContext from '../../context/AuthContext';\nimport propTypes from 'prop-types'\n\n\nexport default class MessageList extends Component {\n  static contextType = AuthContext\n  static prop\n  constructor(props) {\n    super(props);\n    this.state = {\n      currentChannel: this.props.currentChannel,\n      currentChannelName: this.props.currentChannelName,\n      currentUserID: this.props.currentUserID,\n      isChannelCreator: this.props.isChannelCreator,\n      isPrivateChannel: this.props.isPrivateChannel,\n      messages: [],\n      message: \"\",\n      color: \"red\",\n    }\n    this.update = this.update.bind(this);\n  }\n  ws = new WebSocket(\"ws://localhost:3030\")\n  componentDidMount() {\n    const auth = this.context;\n    this.ws.onopen = () => {\n      // on connecting, do nothing but log it to the console\n      console.log('connected')\n    }\n\n    this.ws.onmessage = event => {\n      // on receiving a message, add it to the list of messages\n      console.log(event.data);\n    }\n\n    this.ws.onclose = () => {\n      console.log('disconnected')\n      // automatically try to reconnect on connection loss\n      this.setState({\n        ws: new WebSocket(\"ws://localhost:3030\"),\n      })\n    }\n    this.scrollToBottom();\n  }\n  componentDidUpdate() {\n    this.scrollToBottom();\n  }\n\n  scrollToBottom = () => {\n    this.messagesEnd.scrollIntoView({ behavior: \"smooth\" });\n  }\n\n  componentWillReceiveProps(newProps) {\n    const {auth} = this.context\n    axios.get('https://localhost:4000/v1/channels/'+ newProps.currentChannel, \n    {\n      headers: {\n        \"Authorization\": auth.token\n      }\n    }\n    ).then(response => {\n        console.log(response);\n        let msgs = response.data.map(results => {\n          return {\n            author: results.creatorID,\n            message: results.body,\n            timestamp: results.createdAt,\n            firstName: results.firstname,\n            lastName: results.lastname\n          }\n        })\n        this.setState({messages: msgs});\n    });\n    this.setState({currentChannel: newProps.currentChannel});\n  }\n\n  update = (message) => {\n    // const {auth} = this.context\n    // axios.get('https://localhost:4000/v1/channels/'+ this.state.currentChannel, \n    // {\n    //   headers: {\n    //     \"Authorization\": auth.token\n    //   }\n    // }\n    // ).then(response => {\n    //     let msgs = response.data.map(results => {\n    //       return {\n    //         author: results.creatorID,\n    //         message: results.body,\n    //         timestamp: results.createdAt,\n    //         firstName: results.firstname,\n    //         lastName: results.lastname\n    //       }\n    //     })\n    //     this.setState({messages: msgs});\n    //   });\n    this.ws.send(message);\n  }\n  deleteChannel = (e) => {\n    const {auth} = this.context\n    e.preventDefault();\n    axios.delete(\"https://localhost:4000/v1/channels/\" + this.state.currentChannel, {\n        headers: {\n            Authorization: auth.token\n        }\n    }).then(result => {\n        if (result.status == 200) {\n            window.location.reload(false);\n        }\n    }).catch(e => {\n        console.log(e);\n    });\n  }\n\n  editChannel = (e) => {\n    const {auth} = this.context\n    e.preventDefault();\n    axios({\n        method: 'PATCH', \n        url: \"https://localhost:4000/v1/channels/\" + this.state.currentChannel,\n        headers: {\n            Authorization: auth.token\n        },\n        data: {\n            name: this.channelName.value,\n            description: this.description.value\n        }\n    }).then(result => {\n        if (result.status == 200) {\n            window.location.reload(false);\n        }\n    }).catch(e => {\n        console.log(e);\n    })\n  }\n\n  resetMessage = () => {\n    this.setState({message:\"\", color:\"\"});\n  }\n\n  addUserToChannel = (e) => {\n    const {auth} = this.context\n    e.preventDefault();\n    axios.get('https://localhost:4000/v1/users/'+ this.userName.value, \n    {\n      headers: {\n        \"Authorization\": auth.token\n      }\n    }\n    ).then(response => {\n      axios({\n        method: 'LINK', \n        url: \"https://localhost:4000/v1/channels/\" + this.state.currentChannel,\n        headers: {\n            Authorization: auth.token,\n            Link: response.data\n        },\n      }).then(result => {\n          if (result.status == 200) {\n              this.setState({message: result.data, color: \"green\"});\n          }\n      }).catch(e => {\n        this.setState({message: e.message, color: \"red\"});\n      })\n    });\n  }\n\n  removeUserFromChannel = (e) => {\n    const {auth} = this.context\n    e.preventDefault();\n    axios.get('https://localhost:4000/v1/users/'+ this.removeName.value, \n    {\n      headers: {\n        \"Authorization\": auth.token\n      }\n    }\n    ).then(response => {\n      axios({\n        method: 'UNLINK', \n        url: \"https://localhost:4000/v1/channels/\" + this.state.currentChannel,\n        headers: {\n            Authorization: auth.token,\n            Link: response.data\n        },\n      }).then(result => {\n          console.log(result);\n          if (result.status == 200) {\n            this.setState({message: result.data, color: \"green\"});\n          }\n      }).catch(e => {\n          this.setState({message: e.message, color: \"red\"});\n          console.log(e);\n      })\n    });\n  }\n\n  renderMessages = (messages) => {\n    let MY_USER_ID = this.props.currentUserID;\n    let i = 0;\n    let messageCount = messages.length;\n    let tempMessages = [];\n\n    while (i < messageCount) {\n      let previous = messages[i - 1];\n      let current = messages[i];\n      let next = messages[i + 1];\n      let isMine = current.author === MY_USER_ID;\n      let currentMoment = moment(current.timestamp);\n      let prevBySameAuthor = false;\n      let nextBySameAuthor = false;\n      let startsSequence = true;\n      let endsSequence = true;\n      let showTimestamp = true;\n\n      if (previous) {\n        let previousMoment = moment(previous.timestamp);\n        let previousDuration = moment.duration(currentMoment.diff(previousMoment));\n        prevBySameAuthor = previous.author === current.author;\n        \n        if (prevBySameAuthor && previousDuration.as('hours') < 1) {\n          startsSequence = false;\n        }\n\n        if (previousDuration.as('hours') < 1) {\n          showTimestamp = false;\n        }\n      }\n\n      if (next) {\n        let nextMoment = moment(next.timestamp);\n        let nextDuration = moment.duration(nextMoment.diff(currentMoment));\n        nextBySameAuthor = next.author === current.author;\n\n        if (nextBySameAuthor && nextDuration.as('hours') < 1) {\n          endsSequence = false;\n        }\n      }\n\n      tempMessages.push(\n        <Message\n          key={i}\n          isMine={isMine}\n          startsSequence={startsSequence}\n          endsSequence={endsSequence}\n          showTimestamp={showTimestamp}\n          data={current}\n        />\n      );\n\n      // Proceed to the next message.\n      i += 1;\n    }\n    return tempMessages;\n  }\n  render() {\n    const channelExists = this.state.currentChannel != \"\"\n    const isCreator = this.props.isChannelCreator\n    const isPrivateChannel = this.props.isPrivateChannel\n    return(        \n      <div id=\"channel-header\">\n        <div className=\"message-list\" >\n          <Toolbar\n            title={this.props.currentChannelName}\n            rightItems={[\n              <ToolbarButton key=\"info\" icon=\"ion-ios-information-circle-outline\" />,\n              <ToolbarButton key=\"video\" icon=\"ion-ios-videocam\" />,\n              <ToolbarButton key=\"phone\" icon=\"ion-ios-call\" />\n            ]}\n          />\n          {\n            isCreator ? \n            <div id=\"controls\">\n                {isPrivateChannel ?\n                  <div>\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"50\" viewBox=\"0 0 8 8\" data-toggle=\"modal\" data-target=\"#AddToChannel\">\n                      <path d=\"M3 0v3h-3v2h3v3h2v-3h3v-2h-3v-3h-2z\" />\n                      <title>Add User to Channel</title>\n                    </svg> \n                    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"50\" viewBox=\"0 0 8 8\" data-toggle=\"modal\" data-target=\"#removeFromChannel\">\n                      <path d=\"M0 0v2h8v-2h-8z\" transform=\"translate(0 3)\" />\n                      <title>Remove User from Channel</title>\n                    </svg>\n                    </div>\n                : null\n                }\n                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"50\" viewBox=\"0 0 8 8\" data-toggle=\"modal\" data-target=\"#EditChannel\" data-whatever=\"@mdo\">\n                  <path d=\"M3.5 0l-.5 1.19c-.1.03-.19.08-.28.13l-1.19-.5-.72.72.5 1.19c-.05.1-.09.18-.13.28l-1.19.5v1l1.19.5c.04.1.08.18.13.28l-.5 1.19.72.72 1.19-.5c.09.04.18.09.28.13l.5 1.19h1l.5-1.19c.09-.04.19-.08.28-.13l1.19.5.72-.72-.5-1.19c.04-.09.09-.19.13-.28l1.19-.5v-1l-1.19-.5c-.03-.09-.08-.19-.13-.28l.5-1.19-.72-.72-1.19.5c-.09-.04-.19-.09-.28-.13l-.5-1.19h-1zm.5 2.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5-1.5-.67-1.5-1.5.67-1.5 1.5-1.5z\"/>\n                  <title>Edit Channel</title>\n                </svg>\n                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"50\" viewBox=\"0 0 8 8\" data-toggle=\"modal\" data-target=\"#deleteChannel\" data-whatever=\"@mdo\">\n                  <path d=\"M3 0c-.55 0-1 .45-1 1h-1c-.55 0-1 .45-1 1h7c0-.55-.45-1-1-1h-1c0-.55-.45-1-1-1h-1zm-2 3v4.81c0 .11.08.19.19.19h4.63c.11 0 .19-.08.19-.19v-4.81h-1v3.5c0 .28-.22.5-.5.5s-.5-.22-.5-.5v-3.5h-1v3.5c0 .28-.22.5-.5.5s-.5-.22-.5-.5v-3.5h-1z\" />            \n                  <title>Delete Channel</title>\n                </svg>\n            </div>\n           \n            : null\n          }\n          {channelExists \n            ? <Compose currentChannel={this.state.currentChannel} \n                        update={message => {this.update(message)}} \n                        currentUserFirstName={this.props.currentUserFirstName} \n                        currentUserLastName={this.props.currentUserLastName}\n                        />\n            : <h1>Create or Join Channel</h1>\n          }\n        </div>\n        <div>\n        <div class=\"signup-form\">\n            <div class=\"modal fade\" id=\"EditChannel\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"exampleModalLabel\" aria-hidden=\"true\">\n                <div class=\"modal-dialog\" role=\"document\">\n                    <form class=\"form-horizontal\">\n                        <div class=\"col-xs-8 col-xs-offset-4\">\n                            <h2>Edit Channel</h2>\n                        </div>\t\t\n                        <div class=\"form-group\">\n                            <label class=\"control-label col-xs-4\">Channel Name</label>\n                            <div class=\"col-xs-8\">\n                                <input type=\"text\" class=\"form-control\" name=\"edit_channel_name\" required=\"required\" placeholder={this.state.firstname}\n                                ref={node => (this.channelName = node)}\n                                />\n                            </div>        \t\n                        </div>\n                        <div class=\"form-group\">\n                            <label class=\"control-label col-xs-4\">Description</label>\n                            <div class=\"col-xs-8\">\n                                <input type=\"text\" class=\"form-control\" name=\"edit_channel_description\" placeholder={this.state.lastname}\n                                ref={node => (this.description = node)}\n                                />\n                            </div>        \t\n                        </div>\n                        {/* <div id =\"update-response\" class=\"text-center\">\n                            <p style={{color: this.state.color}}>{this.state.message}</p>\n                        </div> */}\n                        <div class=\"form-group\">\n                            <div class=\"col-xs-8 col-xs-offset-4\">\n                                <button class=\"btn btn-primary btn-sm\" onClick={(e) => {this.editChannel(e)}}>Save</button>\n                            </div>  \n                            <div class=\"col-xs-8 col-xs-offset-4\">\n                                <button type=\"button\" class=\"btn btn-primary btn-sm\" data-dismiss=\"modal\"\n                                >\n                                    Close</button>\n                            </div>  \n                        </div>\t\n                    </form>\n                </div>\n            </div>\n        </div>\n        <div class=\"signup-form\">\n            <div class=\"modal fade\" id=\"deleteChannel\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"exampleModalLabel\" aria-hidden=\"true\">\n                <div class=\"modal-dialog\" role=\"document\">\n                    <form class=\"form-horizontal\">\n                        <h2>Are you sure you want to delete this channel?</h2>\n                        <div class=\"form-group\">\n                            <div class=\"col-xs-8 col-xs-offset-4\">\n                                <button class=\"btn btn-primary btn-sm\" onClick={(e) => {this.deleteChannel(e)}}>YES</button>\n                            </div>  \n                            <div class=\"col-xs-8 col-xs-offset-4\">\n                                <button type=\"button\" class=\"btn btn-primary btn-sm\" data-dismiss=\"modal\"\n                                >\n                                    NO</button>\n                            </div>  \n                        </div>\t\n                    </form>\n                </div>\n            </div>\n        </div>\n        <div class=\"signup-form\">\n            <div class=\"modal fade\" id=\"AddToChannel\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"exampleModalLabel\" aria-hidden=\"true\">\n                <div class=\"modal-dialog\" role=\"document\">\n                    <form class=\"form-horizontal\">\n                        <div class=\"col-xs-8 col-xs-offset-4\">\n                            <h2>Add User to Channel</h2>\n                        </div>\t\t\n                        <div class=\"form-group\">\n                            <label class=\"control-label col-xs-4\">Username</label>\n                            <div class=\"col-xs-8\">\n                                <input type=\"text\" class=\"form-control\" name=\"edit_channel_name\" required=\"required\" placeholder={this.state.firstname}\n                                ref={node => (this.userName = node)}\n                                />\n                            </div>        \t\n                        </div>\n                        <div id =\"add-response\" class=\"text-center\">\n                            <p style={{color: this.state.color}}>{this.state.message}</p>\n                        </div>\n                        <div class=\"form-group\">\n                            <div class=\"col-xs-8 col-xs-offset-4\">\n                                <button class=\"btn btn-primary btn-sm\" onClick={(e) => {this.addUserToChannel(e)}}>Add</button>\n                            </div>  \n                            <div class=\"col-xs-8 col-xs-offset-4\">\n                                <button type=\"button\" class=\"btn btn-primary btn-sm\" data-dismiss=\"modal\" onClick={this.resetMessage}\n                                >\n                                    Close</button>\n                            </div>  \n                        </div>\t\n                    </form>\n                </div>\n            </div>\n        </div>\n        <div class=\"signup-form\">\n            <div class=\"modal fade\" id=\"removeFromChannel\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"exampleModalLabel\" aria-hidden=\"true\">\n                <div class=\"modal-dialog\" role=\"document\">\n                    <form class=\"form-horizontal\">\n                        <div class=\"col-xs-8 col-xs-offset-4\">\n                            <h2>Remove User From Channel</h2>\n                        </div>\t\t\n                        <div class=\"form-group\">\n                            <label class=\"control-label col-xs-4\">Username</label>\n                            <div class=\"col-xs-8\">\n                                <input type=\"text\" class=\"form-control\" name=\"edit_channel_name\" required=\"required\" placeholder={this.state.firstname}\n                                ref={node => (this.removeName = node)}\n                                />\n                            </div>        \t\n                        </div>\n                        <div id =\"remove-response\" class=\"text-center\">\n                            <p style={{color: this.state.color}}>{this.state.message}</p>\n                        </div>\n                        <div class=\"form-group\">\n                            <div class=\"col-xs-8 col-xs-offset-4\">\n                                <button class=\"btn btn-primary btn-sm\" onClick={(e) => {this.removeUserFromChannel(e)}}>Remove</button>\n                            </div>  \n                            <div class=\"col-xs-8 col-xs-offset-4\">\n                                <button type=\"button\" class=\"btn btn-primary btn-sm\" data-dismiss=\"modal\" onClick={this.resetMessage}\n                                >\n                                    Close</button>\n                            </div>  \n                        </div>\t\n                    </form>\n                </div>\n            </div>\n        </div>\n        </div>\n        <div className=\"message-list-container\">\n            {\n              this.renderMessages(this.state.messages)\n            }\n          </div>\n        <div style={{ float:\"left\", clear: \"both\" }}\n          ref={(el) => { this.messagesEnd = el; }}>\n        </div>\n      </div>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}